# 常见问题解答 (FAQ)

## 一般问题

### Q: Device Monitor 是什么？

A: Device Monitor 是一个基于 Tauri 2.0 开发的跨平台设备监控应用，主要用于 Android 平台。它可以定期收集设备的系统信息（CPU、内存、磁盘、网络等）并通过 HTTP POST 请求发送到指定的服务器。

### Q: 为什么选择 Tauri？

A: Tauri 是一个轻量级的跨平台应用框架，具有以下优势：
- 应用体积小（相比 Electron）
- 性能好（使用 Rust 后端）
- 跨平台支持（桌面 + 移动）
- 安全性高
- 开发体验好（支持现代 Web 技术栈）

### Q: 这个应用需要 Root 权限吗？

A: 不需要。所有功能都使用标准 Android API 实现，无需 Root 权限。

### Q: 支持哪些平台？

A: 当前版本主要支持 Android 7.0+。理论上也支持桌面平台（Windows、macOS、Linux），但主要针对 Android 进行了优化。

## 安装和构建

### Q: 构建 APK 需要多长时间？

A: 首次构建大约需要 10-20 分钟，因为需要下载依赖和编译 Rust 代码。后续构建会快很多（2-5 分钟）。

### Q: 构建失败，提示找不到 NDK

A: 确保：
1. 已安装 Android NDK 26.1.10909125
2. 设置了 NDK_HOME 环境变量
3. NDK 路径正确

```bash
# 安装 NDK
sdkmanager "ndk;26.1.10909125"

# 设置环境变量
export NDK_HOME=$ANDROID_HOME/ndk/26.1.10909125
```

### Q: 如何在不同架构上测试？

A: Tauri 自动构建多架构 APK：
- `arm64-v8a` - 64位 ARM（大多数现代设备）
- `armeabi-v7a` - 32位 ARM（旧设备）
- `x86_64` - 64位 x86（模拟器）
- `universal` - 通用版本（包含所有架构，体积较大）

推荐使用 `universal` 版本进行测试。

### Q: GitHub Actions 构建失败

A: 常见原因：
1. NDK 版本不匹配
2. Rust 工具链问题
3. 内存不足

检查 workflow 日志查看具体错误。

## 权限问题

### Q: "使用情况访问"权限有什么用？

A: 这个权限允许应用获取：
- 应用使用统计信息
- 前台应用信息
- 应用运行时间统计

这是 Android 系统的特殊权限，需要用户手动在设置中授予。

### Q: 如何授予"使用情况访问"权限？

A: 
1. 打开"设置"
2. 进入"安全与隐私" > "特殊应用权限"
3. 选择"使用情况访问"
4. 找到 Device Monitor
5. 启用权限

或者在应用中点击启动监控时，会自动引导您到设置页面。

### Q: 为什么需要这么多权限？

A: 应用只请求必要的权限：
- `INTERNET` - 发送数据到服务器（必需）
- `ACCESS_NETWORK_STATE` - 检测网络状态（必需）
- `PACKAGE_USAGE_STATS` - 获取应用统计（可选，但推荐）
- `BATTERY_STATS` - 获取电池信息（可选）
- `WAKE_LOCK` - 保持后台运行（必需）

## 功能问题

### Q: 能获取哪些设备信息？

A: 当前版本支持：
- ✅ CPU 使用率（所有核心）
- ✅ 内存使用情况
- ✅ 磁盘/存储信息
- ✅ 网络流量统计
- ✅ 电池状态
- ✅ 进程列表
- ✅ 系统运行时间
- ✅ 设备名称

### Q: 为什么无法获取其他应用的窗口标题？

A: Android 5.0+ 后，出于隐私和安全考虑，系统限制了应用获取其他应用详细信息的能力。即使使用无障碍服务，也只能获取包名和应用名，无法获取具体的窗口标题（除非是自己的应用）。

### Q: 为什么进程的 CPU 使用率总是 0？

A: 这是 Android 系统的限制。从 Android 7.0 开始，应用无法获取其他应用的实时 CPU 使用率，只能获取自己的。应用会收集系统整体的 CPU 使用率。

### Q: 能否在后台持续运行？

A: 可以，但需要：
1. 授予所有必要权限
2. 关闭电池优化
3. 允许后台运行（部分手机需要）
4. 允许自启动（部分厂商）

不同手机厂商的限制不同，小米、华为等可能需要额外配置。

### Q: 发送间隔最小可以设置多少？

A: 最小 5 秒，但不推荐设置太小的值，因为：
- 增加电量消耗
- 增加网络流量
- 可能被服务器限流
- 对设备性能有影响

推荐设置 30-60 秒。

## 网络问题

### Q: 无法连接到服务器

A: 检查：
1. 服务器是否在运行
2. 服务器地址是否正确（包括端口）
3. 手机和服务器是否在同一网络
4. 防火墙是否阻止连接
5. 如果使用 HTTP，是否配置了网络安全策略

### Q: 如何使用 HTTP 连接（非 HTTPS）？

A: Android 默认不允许使用明文 HTTP。开发环境可以配置网络安全策略，但生产环境强烈建议使用 HTTPS。

详见 [ANDROID_GUIDE.md](ANDROID_GUIDE.md) 中的"网络配置"部分。

### Q: 真实设备如何连接本地服务器？

A: 有两种方法：

**方法 1: USB 端口转发**
```bash
adb reverse tcp:3000 tcp:3000
```
然后使用 `http://localhost:3000`

**方法 2: 局域网**
使用电脑的 IP 地址，如 `http://192.168.1.100:3000`

### Q: Android 模拟器如何连接本地服务器？

A: 使用特殊 IP：`http://10.0.2.2:3000`

这个 IP 会自动转发到宿主机的 localhost。

## 数据相关

### Q: 发送的数据格式是什么？

A: JSON 格式，包含完整的设备信息。示例见 README 或服务器示例代码。

### Q: 如何保护数据隐私？

A: 建议：
1. 使用 HTTPS 加密传输
2. 实现服务器端认证（API Key、JWT 等）
3. 对敏感信息进行脱敏
4. 遵守隐私政策和法律法规
5. 明确告知用户收集的数据

### Q: 数据发送失败会怎样？

A: 当前版本会记录错误状态并显示在界面上，但不会保存失败的数据。未来版本计划添加：
- 本地缓存
- 自动重试
- 离线队列

### Q: 能否修改发送的数据格式？

A: 可以，修改 `src-tauri/src/sender.rs` 中的 `post_device_info()` 函数。

## 性能问题

### Q: 应用耗电量如何？

A: 取决于发送间隔：
- 30 秒间隔：低耗电
- 10 秒间隔：中等耗电
- 5 秒间隔：较高耗电

主要耗电因素：
- 数据收集（CPU）
- 网络传输
- 后台保活

### Q: 应用占用多少内存？

A: 通常情况下：
- 前台运行：30-50 MB
- 后台运行：20-30 MB

这对于现代手机来说是很小的开销。

### Q: 会影响手机性能吗？

A: 正常使用不会。应用使用异步处理，不会阻塞主线程。数据收集也是轻量级的。

## 开发问题

### Q: 如何调试 Android 应用？

A: 
```bash
# 查看实时日志
adb logcat | grep -i "device-monitor"

# 查看错误日志
adb logcat *:E

# 安装调试版本
adb install -r path/to/debug.apk
```

### Q: 如何添加新的设备信息收集？

A: 
1. 在 `device_info.rs` 中添加数据结构
2. 实现收集逻辑
3. 在 `get_device_info()` 中调用
4. 更新前端显示（如需要）

### Q: 如何贡献代码？

A: 
1. Fork 仓库
2. 创建特性分支
3. 提交更改
4. 创建 Pull Request

详见 [CONTRIBUTING.md](CONTRIBUTING.md)。

### Q: 支持 iOS 吗？

A: 当前版本不支持。Tauri 2.0 理论上支持 iOS，但需要额外的开发工作。未来版本可能会添加 iOS 支持。

## 其他问题

### Q: 这是开源项目吗？

A: 是的，采用 MIT 许可证。您可以自由使用、修改和分发。

### Q: 可以用于商业项目吗？

A: 可以，MIT 许可证允许商业使用。但请注意：
1. 遵守许可证条款
2. 遵守隐私法规（如 GDPR）
3. 实现必要的安全措施
4. 获取用户同意

### Q: 如何获取帮助？

A: 
1. 查看文档（README、指南等）
2. 搜索 Issues
3. 创建新 Issue
4. 查看代码注释

### Q: 项目会持续维护吗？

A: 这取决于社区的参与。欢迎提交 Issue 和 PR！

### Q: 如何报告安全漏洞？

A: 请不要公开发布安全问题。建议通过私密方式联系维护者，或创建 Security Advisory。

---

**没找到您的问题？**

请在 [GitHub Issues](https://github.com/your-repo/issues) 提问，我们会尽快回复！

